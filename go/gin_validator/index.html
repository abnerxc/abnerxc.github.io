<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1">




<title>gin_validator | Abnerçš„åšå®¢</title>
<link rel="canonical" href="https://abnerxc.github.io/go/gin_validator/">
<meta property="og:type" content="article" />
<meta property="og:title" content="gin_validator | Abnerçš„åšå®¢" />
<meta property="og:url" content="https://abnerxc.github.io/go/gin_validator/" />








<link rel="stylesheet" href="/lib/icofont/icofont.min.css" />
<link rel="stylesheet" href="/css/syntax.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/custom.css" />
<script src="/js/copy-code-block.js"></script>
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

    </head>

    <body>
        <header class="header-wrapper">
    <div class="header">
        <a class="site-title" href="https://abnerxc.github.io/">Abnerçš„åšå®¢</a>

        <nav class="menu">
            
        </nav>
    </div>
</header>

        <main class="main-wrapper">
            <div class="main">
                

<section class="single">
    <h1 class="title">gin_validator</h1>

    <div class="tip">
        <time datetime="2021-06-13 18:35:11 &#43;0800 CST">2021/06/13</time>
        <span class="split">Â·</span>
        <span> 713 words </span>
        <span class="split">Â·</span>
        <span>
            4 minutes to read
        </span>
    </div>

    <div class="taxonomies">
        
        <div>
            Categories:
            
                <a href="/categories/go">Go</a>
            
        </div>
        

        
    </div>

    
    
    <div class="post-toc">
        <h3>ç›®å½•</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#æ¦‚è¿°">æ¦‚è¿°</a></li>
    <li><a href="#æ“ä½œç¬¦è¯´æ˜">æ“ä½œç¬¦è¯´æ˜</a></li>
    <li><a href="#å¸¸ç”¨æ ‡è®°è¯´æ˜">å¸¸ç”¨æ ‡è®°è¯´æ˜</a></li>
    <li><a href="#ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹</a></li>
    <li><a href="#ginæ¡†æ¶ä¸­ä½¿ç”¨éªŒè¯å™¨">ginæ¡†æ¶ä¸­ä½¿ç”¨éªŒè¯å™¨</a></li>
  </ul>
</nav>
    </div>
    

    <hr />

    <div class="content">
        <h1 id="æ¦‚è¿°">æ¦‚è¿° <a href="#%e6%a6%82%e8%bf%b0" class="anchor">ğŸ”—</a></h1><p>åœ¨æ¥å£å¼€å‘ç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜æ˜¯åç«¯éœ€è¦å†™å¤§é‡çš„ç¹çä»£ç è¿›è¡Œæ•°æ®æ ¡éªŒï¼Œæ‰€ä»¥å°±æƒ³ç€æœ‰æ²¡æœ‰åƒå‰ç«¯æ ¡éªŒä¸€æ ·å†™è§„åˆ™è¿›è¡ŒåŒ¹é…æ ¡éªŒï¼Œç„¶åå°±å‘ç°äº†validatoråŒ…ï¼Œä¸€ä¸ªæ¯”è¾ƒå¼ºå¤§çš„æ ¡éªŒå·¥å…·åŒ…ä¸‹é¢æ˜¯ä¸€äº›å­¦ä¹ æ€»ç»“ï¼Œè¯¦ç»†å†…å®¹å¯ä»¥æŸ¥çœ‹<a href="https://github.com/go-playground/validator">validator</a>
åŒ…ä¸‹è½½ï¼šgo get github.com/go-playground/validator/v10</p>
<h1 id="æ“ä½œç¬¦è¯´æ˜">æ“ä½œç¬¦è¯´æ˜ <a href="#%e6%93%8d%e4%bd%9c%e7%ac%a6%e8%af%b4%e6%98%8e" class="anchor">ğŸ”—</a></h1><table>
  <thead>
      <tr>
          <th>æ ‡è®°</th>
          <th>æ ‡è®°è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>,</td>
          <td>å¤šæ“ä½œç¬¦åˆ†å‰²</td>
      </tr>
      <tr>
          <td>|</td>
          <td>æˆ–æ“ä½œç¬¦</td>
      </tr>
      <tr>
          <td>-</td>
          <td>è·³è¿‡éªŒè¯å­—æ®µ</td>
      </tr>
  </tbody>
</table>
<h1 id="å¸¸ç”¨æ ‡è®°è¯´æ˜">å¸¸ç”¨æ ‡è®°è¯´æ˜ <a href="#%e5%b8%b8%e7%94%a8%e6%a0%87%e8%ae%b0%e8%af%b4%e6%98%8e" class="anchor">ğŸ”—</a></h1><table>
  <thead>
      <tr>
          <th>æ ‡è®°</th>
          <th>æ ‡è®°è¯´æ˜</th>
          <th>ä¾‹</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>required</td>
          <td>å¿…å¡«</td>
          <td>Fieldæˆ–Structvalidate:&ldquo;required&rdquo;,å¦‚æœint,0ä½œä¸ºç‰¹æ®Šå¯é€šè¿‡*intåˆ¤æ–­</td>
      </tr>
      <tr>
          <td>omitempty</td>
          <td>ç©ºæ—¶å¿½ç•¥</td>
          <td>Fieldæˆ–Structvalidate:&ldquo;omitempty&rdquo;</td>
      </tr>
      <tr>
          <td>len</td>
          <td>é•¿åº¦</td>
          <td>Fieldvalidate:&ldquo;len=0&rdquo;</td>
      </tr>
      <tr>
          <td>eq</td>
          <td>ç­‰äº</td>
          <td>Fieldvalidate:&ldquo;eq=0&rdquo;</td>
      </tr>
      <tr>
          <td>gt</td>
          <td>å¤§äº</td>
          <td>Fieldvalidate:&ldquo;gt=0&rdquo;</td>
      </tr>
      <tr>
          <td>gte</td>
          <td>å¤§äºç­‰äº</td>
          <td>Fieldvalidate:&ldquo;gte=0&rdquo;</td>
      </tr>
      <tr>
          <td>lt</td>
          <td>å°äº</td>
          <td>Fieldvalidate:&ldquo;lt=0&rdquo;</td>
      </tr>
      <tr>
          <td>lte</td>
          <td>å°äºç­‰äº</td>
          <td>Fieldvalidate:&ldquo;lte=0&rdquo;</td>
      </tr>
      <tr>
          <td>eqfield</td>
          <td>åŒä¸€ç»“æ„ä½“å­—æ®µç›¸ç­‰</td>
          <td>Fieldvalidate:&ldquo;eqfield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>nefield</td>
          <td>åŒä¸€ç»“æ„ä½“å­—æ®µä¸ç›¸ç­‰</td>
          <td>Fieldvalidate:&ldquo;nefield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>gtfield</td>
          <td>å¤§äºåŒä¸€ç»“æ„ä½“å­—æ®µ</td>
          <td>Fieldvalidate:&ldquo;gtfield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>gtefield</td>
          <td>å¤§äºç­‰äºåŒä¸€ç»“æ„ä½“å­—æ®µ</td>
          <td>Fieldvalidate:&ldquo;gtefield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>ltfield</td>
          <td>å°äºåŒä¸€ç»“æ„ä½“å­—æ®µ</td>
          <td>Fieldvalidate:&ldquo;ltfield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>ltefield</td>
          <td>å°äºç­‰äºåŒä¸€ç»“æ„ä½“å­—æ®µ</td>
          <td>Fieldvalidate:&ldquo;ltefield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>eqcsfield</td>
          <td>è·¨ä¸åŒç»“æ„ä½“å­—æ®µç›¸ç­‰</td>
          <td>Struct1.Fieldvalidate:&ldquo;eqcsfield=Struct2.Field2&rdquo;</td>
      </tr>
      <tr>
          <td>necsfield</td>
          <td>è·¨ä¸åŒç»“æ„ä½“å­—æ®µä¸ç›¸ç­‰</td>
          <td>Struct1.Fieldvalidate:&ldquo;necsfield=Struct2.Field2&rdquo;</td>
      </tr>
      <tr>
          <td>gtcsfield</td>
          <td>å¤§äºè·¨ä¸åŒç»“æ„ä½“å­—æ®µ</td>
          <td>Struct1.Fieldvalidate:&ldquo;gtcsfield=Struct2.Field2&rdquo;</td>
      </tr>
      <tr>
          <td>gtecsfield</td>
          <td>å¤§äºç­‰äºè·¨ä¸åŒç»“æ„ä½“å­—æ®µ</td>
          <td>Struct1.Fieldvalidate:&ldquo;gtecsfield=Struct2.Field2&rdquo;</td>
      </tr>
      <tr>
          <td>ltcsfield</td>
          <td>å°äºè·¨ä¸åŒç»“æ„ä½“å­—æ®µ</td>
          <td>Struct1.Fieldvalidate:&ldquo;ltcsfield=Struct2.Field2&rdquo;</td>
      </tr>
      <tr>
          <td>ltecsfield</td>
          <td>å°äºç­‰äºè·¨ä¸åŒç»“æ„ä½“å­—æ®µ</td>
          <td>Struct1.Fieldvalidate:&ldquo;ltecsfield=Struct2.Field2&rdquo;</td>
      </tr>
      <tr>
          <td>min</td>
          <td>æœ€å¤§å€¼</td>
          <td>Fieldvalidate:&ldquo;min=1&rdquo;</td>
      </tr>
      <tr>
          <td>max</td>
          <td>æœ€å°å€¼</td>
          <td>Fieldvalidate:&ldquo;max=2&rdquo;</td>
      </tr>
      <tr>
          <td>structonly</td>
          <td>ä»…éªŒè¯ç»“æ„ä½“ï¼Œä¸éªŒè¯ä»»ä½•ç»“æ„ä½“å­—æ®µ</td>
          <td>Structvalidate:&ldquo;structonly&rdquo;</td>
      </tr>
      <tr>
          <td>nostructlevel</td>
          <td>ä¸è¿è¡Œä»»ä½•ç»“æ„çº§åˆ«çš„éªŒè¯</td>
          <td>Structvalidate:&ldquo;nostructlevel&rdquo;</td>
      </tr>
      <tr>
          <td>dive</td>
          <td>å‘ä¸‹å»¶ä¼¸éªŒè¯ï¼Œå¤šå±‚å‘ä¸‹éœ€è¦å¤šä¸ªdiveæ ‡è®°</td>
          <td>[][]stringvalidate:&ldquo;gt=0,dive,len=1,dive,required&rdquo;</td>
      </tr>
      <tr>
          <td>diveKeys&amp;EndKeys</td>
          <td>ä¸diveåŒæ—¶ä½¿ç”¨ï¼Œç”¨äºå¯¹mapå¯¹è±¡çš„é”®çš„å’Œå€¼çš„éªŒè¯ï¼Œkeysä¸ºé”®ï¼Œendkeysä¸ºå€¼</td>
          <td>map[string]stringvalidate:&ldquo;gt=0,dive,keys,eq=1|eq=2,endkeys,required&rdquo;</td>
      </tr>
      <tr>
          <td>required_with</td>
          <td>å…¶ä»–å­—æ®µå…¶ä¸­ä¸€ä¸ªä¸ä¸ºç©ºä¸”å½“å‰å­—æ®µä¸ä¸ºç©º</td>
          <td>Fieldvalidate:&ldquo;required_with=Field1Field2&rdquo;</td>
      </tr>
      <tr>
          <td>required_with_all</td>
          <td>å…¶ä»–æ‰€æœ‰å­—æ®µä¸ä¸ºç©ºä¸”å½“å‰å­—æ®µä¸ä¸ºç©º</td>
          <td>Fieldvalidate:&ldquo;required_with_all=Field1Field2&rdquo;</td>
      </tr>
      <tr>
          <td>required_without</td>
          <td>å…¶ä»–å­—æ®µå…¶ä¸­ä¸€ä¸ªä¸ºç©ºä¸”å½“å‰å­—æ®µä¸ä¸ºç©º</td>
          <td>Field`validate:&ldquo;required_without=Field1Field2&rdquo;</td>
      </tr>
      <tr>
          <td>required_without_all</td>
          <td>å…¶ä»–æ‰€æœ‰å­—æ®µä¸ºç©ºä¸”å½“å‰å­—æ®µä¸ä¸ºç©º</td>
          <td>Fieldvalidate:&ldquo;required_without_all=Field1Field2&rdquo;</td>
      </tr>
      <tr>
          <td>isdefault</td>
          <td>æ˜¯é»˜è®¤å€¼</td>
          <td>Fieldvalidate:&ldquo;isdefault=0&rdquo;</td>
      </tr>
      <tr>
          <td>oneof</td>
          <td>å…¶ä¸­ä¹‹ä¸€</td>
          <td>Fieldvalidate:&ldquo;oneof=579&rdquo;</td>
      </tr>
      <tr>
          <td>containsfield</td>
          <td>å­—æ®µåŒ…å«å¦ä¸€ä¸ªå­—æ®µ</td>
          <td>Fieldvalidate:&ldquo;containsfield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>excludesfield</td>
          <td>å­—æ®µä¸åŒ…å«å¦ä¸€ä¸ªå­—æ®µ</td>
          <td>Fieldvalidate:&ldquo;excludesfield=Field2&rdquo;</td>
      </tr>
      <tr>
          <td>unique</td>
          <td>æ˜¯å¦å”¯ä¸€ï¼Œé€šå¸¸ç”¨äºåˆ‡ç‰‡æˆ–ç»“æ„ä½“</td>
          <td>Fieldvalidate:&ldquo;unique&rdquo;</td>
      </tr>
      <tr>
          <td>alphanum</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åªåŒ…å«ASCIIå­—æ¯æ•°å­—å­—ç¬¦</td>
          <td>Fieldvalidate:&ldquo;alphanum&rdquo;</td>
      </tr>
      <tr>
          <td>alphaunicode</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åªåŒ…å«unicodeå­—ç¬¦</td>
          <td>Fieldvalidate:&ldquo;alphaunicode&rdquo;</td>
      </tr>
      <tr>
          <td>alphanumunicode</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åªåŒ…å«unicodeå­—æ¯æ•°å­—å­—ç¬¦</td>
          <td>Fieldvalidate:&ldquo;alphanumunicode&rdquo;</td>
      </tr>
      <tr>
          <td>numeric</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«åŸºæœ¬çš„æ•°å€¼</td>
          <td>Fieldvalidate:&ldquo;numeric&rdquo;</td>
      </tr>
      <tr>
          <td>hexadecimal</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„åå…­è¿›åˆ¶</td>
          <td>Fieldvalidate:&ldquo;hexadecimal&rdquo;</td>
      </tr>
      <tr>
          <td>hexcolor</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„åå…­è¿›åˆ¶é¢œè‰²</td>
          <td>Fieldvalidate:&ldquo;hexcolor&rdquo;</td>
      </tr>
      <tr>
          <td>lowercase</td>
          <td>ç¬¦ä¸²å€¼æ˜¯å¦åªåŒ…å«å°å†™å­—ç¬¦</td>
          <td>Fieldvalidate:&ldquo;lowercase&rdquo;</td>
      </tr>
      <tr>
          <td>uppercase</td>
          <td>ç¬¦ä¸²å€¼æ˜¯å¦åªåŒ…å«å¤§å†™å­—ç¬¦</td>
          <td>Fieldvalidate:&ldquo;uppercase&rdquo;</td>
      </tr>
      <tr>
          <td>email</td>
          <td>å­—ç¬¦ä¸²å€¼åŒ…å«ä¸€ä¸ªæœ‰æ•ˆçš„ç”µå­é‚®ä»¶</td>
          <td>Fieldvalidate:&ldquo;email&rdquo;</td>
      </tr>
      <tr>
          <td>json</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦ä¸ºæœ‰æ•ˆçš„JSON</td>
          <td>Fieldvalidate:&ldquo;json&rdquo;</td>
      </tr>
      <tr>
          <td>file</td>
          <td>ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„æ–‡ä»¶è·¯å¾„ï¼Œä»¥åŠè¯¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨äºè®¡ç®—æœºä¸Š</td>
          <td>Fieldvalidate:&ldquo;file&rdquo;</td>
      </tr>
      <tr>
          <td>url</td>
          <td>ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„url</td>
          <td>Fieldvalidate:&ldquo;url&rdquo;</td>
      </tr>
      <tr>
          <td>uri</td>
          <td>ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„uri</td>
          <td>Fieldvalidate:&ldquo;uri&rdquo;</td>
      </tr>
      <tr>
          <td>base64</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„base64å€¼</td>
          <td>Fieldvalidate:&ldquo;base64&rdquo;</td>
      </tr>
      <tr>
          <td>contains</td>
          <td>å­—ç¬¦ä¸²å€¼åŒ…å«å­å­—ç¬¦ä¸²å€¼</td>
          <td>Fieldvalidate:&ldquo;contains=@&rdquo;</td>
      </tr>
      <tr>
          <td>containsany</td>
          <td>å­—ç¬¦ä¸²å€¼åŒ…å«å­å­—ç¬¦ä¸²å€¼ä¸­çš„ä»»ä½•å­—ç¬¦</td>
          <td>Fieldvalidate:&ldquo;containsany=abc&rdquo;</td>
      </tr>
      <tr>
          <td>containsrune</td>
          <td>å­—ç¬¦ä¸²å€¼åŒ…å«æä¾›çš„ç‰¹æ®Šç¬¦å·å€¼</td>
          <td>Fieldvalidate:&ldquo;containsrune=â˜¢&rdquo;</td>
      </tr>
      <tr>
          <td>excludes</td>
          <td>å­—ç¬¦ä¸²å€¼ä¸åŒ…å«å­å­—ç¬¦ä¸²å€¼</td>
          <td>Fieldvalidate:&ldquo;excludes=@&rdquo;</td>
      </tr>
      <tr>
          <td>excludesall</td>
          <td>å­—ç¬¦ä¸²å€¼ä¸åŒ…å«ä»»ä½•å­å­—ç¬¦ä¸²å€¼</td>
          <td>Fieldvalidate:&ldquo;excludesall=abc&rdquo;</td>
      </tr>
      <tr>
          <td>excludesrune</td>
          <td>å­—ç¬¦ä¸²å€¼ä¸åŒ…å«æä¾›çš„ç‰¹æ®Šç¬¦å·å€¼</td>
          <td>Fieldvalidate:&ldquo;containsrune=â˜¢&rdquo;</td>
      </tr>
      <tr>
          <td>startswith</td>
          <td>å­—ç¬¦ä¸²ä»¥æä¾›çš„å­—ç¬¦ä¸²å€¼å¼€å§‹</td>
          <td>Fieldvalidate:&ldquo;startswith=abc&rdquo;</td>
      </tr>
      <tr>
          <td>endswith</td>
          <td>å­—ç¬¦ä¸²ä»¥æä¾›çš„å­—ç¬¦ä¸²å€¼ç»“æŸ</td>
          <td>Fieldvalidate:&ldquo;endswith=abc&rdquo;</td>
      </tr>
      <tr>
          <td>ip</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„IPåœ°å€</td>
          <td>Fieldvalidate:&ldquo;ip&rdquo;</td>
      </tr>
      <tr>
          <td>ipv4</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„ipv4åœ°å€</td>
          <td>Fieldvalidate:&ldquo;ipv4&rdquo;</td>
      </tr>
      <tr>
          <td>datetime</td>
          <td>å­—ç¬¦ä¸²å€¼æ˜¯å¦åŒ…å«æœ‰æ•ˆçš„æ—¥æœŸ</td>
          <td>Fieldvalidate:&ldquo;datetime&rdquo;</td>
      </tr>
  </tbody>
</table>
<h1 id="ä½¿ç”¨ç¤ºä¾‹">ä½¿ç”¨ç¤ºä¾‹ <a href="#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b" class="anchor">ğŸ”—</a></h1><h2 id="ä½¿ç”¨æ³¨æ„">ä½¿ç”¨æ³¨æ„ <a href="#%e4%bd%bf%e7%94%a8%e6%b3%a8%e6%84%8f" class="anchor">ğŸ”—</a></h2><ol>
<li>å½“æœç´¢æ¡ä»¶ä¸ç‰¹æ®Šæ ‡è®°å†²çªæ—¶,å¦‚ï¼šé€—å·ï¼ˆ,ï¼‰ï¼Œæˆ–æ“ä½œï¼ˆ|ï¼‰ï¼Œä¸­æ¨ªçº¿ï¼ˆ-ï¼‰ç­‰åˆ™éœ€è¦ä½¿ç”¨ UTF-8åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼</li>
</ol>
<pre tabindex="0"><code>type Test struct {
   Field1 string  `validate:&#34;excludesall=|&#34;`    // é”™è¯¯
   Field2 string `validate:&#34;excludesall=0x7C&#34;` // æ­£ç¡®.
}
</code></pre><ol start="2">
<li>å¯é€šè¿‡validationErrors := errs.(validator.ValidationErrors)è·å–é”™è¯¯å¯¹è±¡è‡ªå®šä¹‰è¿”å›å“åº”é”™è¯¯</li>
<li>è‡ªå®šä¹‰æ ¡éªŒç»“æœç¿»è¯‘</li>
</ol>
<pre tabindex="0"><code>// åˆå§‹åŒ–ç¿»è¯‘å™¨
func validateInit() {
	zh_ch := zh.New()
	uni := ut.New(zh_ch)               // ä¸‡èƒ½ç¿»è¯‘å™¨ï¼Œä¿å­˜æ‰€æœ‰çš„è¯­è¨€ç¯å¢ƒå’Œç¿»è¯‘æ•°æ®
	Trans, _ = uni.GetTranslator(&#34;zh&#34;) // ç¿»è¯‘å™¨
	Validate = validator.New()
	_ = zh_translations.RegisterDefaultTranslations(Validate, Trans)
	// æ·»åŠ é¢å¤–ç¿»è¯‘
	_ = Validate.RegisterTranslation(&#34;required_without&#34;, Trans, func(ut ut.Translator) error {
		return ut.Add(&#34;required_without&#34;, &#34;{0} ä¸ºå¿…å¡«å­—æ®µ!&#34;, true)
	}, func(ut ut.Translator, fe validator.FieldError) string {
		t, _ := ut.T(&#34;required_without&#34;, fe.Field())
		return t
	})
}
</code></pre><h2 id="ä½¿ç”¨ç¤ºä¾‹-1">ä½¿ç”¨ç¤ºä¾‹ <a href="#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b-1" class="anchor">ğŸ”—</a></h2><pre tabindex="0"><code>package main
import (
   &#34;fmt&#34;
   &#34;github.com/go-playground/validator/v10&#34;
)
// å®ä¾‹åŒ–éªŒè¯å¯¹è±¡
var validate = validator.New()
func main() {
   // ç»“æ„ä½“éªŒè¯
   type Inner struct {
      String string `validate:&#34;contains=111&#34;`
   }
   inner := &amp;Inner{String: &#34;11@&#34;}
   errs := validate.Struct(inner)
   if errs != nil {
      fmt.Println(errs.Error())
   }
   // å˜é‡éªŒè¯
   m := map[string]string{&#34;&#34;: &#34;&#34;, &#34;val3&#34;: &#34;val3&#34;}
   errs = validate.Var(m, &#34;required,dive,keys,required,endkeys,required&#34;)
   if errs != nil {
      fmt.Println(errs.Error())
   }
}
</code></pre><h1 id="ginæ¡†æ¶ä¸­ä½¿ç”¨éªŒè¯å™¨">ginæ¡†æ¶ä¸­ä½¿ç”¨éªŒè¯å™¨ <a href="#gin%e6%a1%86%e6%9e%b6%e4%b8%ad%e4%bd%bf%e7%94%a8%e9%aa%8c%e8%af%81%e5%99%a8" class="anchor">ğŸ”—</a></h1><h2 id="å®šä¹‰é”™è¯¯ç¿»è¯‘å™¨">å®šä¹‰é”™è¯¯ç¿»è¯‘å™¨ <a href="#%e5%ae%9a%e4%b9%89%e9%94%99%e8%af%af%e7%bf%bb%e8%af%91%e5%99%a8" class="anchor">ğŸ”—</a></h2><pre tabindex="0"><code>package xcore

import (
	&#34;fmt&#34;
	&#34;github.com/gin-gonic/gin/binding&#34;
	&#34;reflect&#34;
	&#34;strings&#34;
	//ginè¡¨å•éªŒè¯
	&#34;github.com/go-playground/locales/en&#34;
	&#34;github.com/go-playground/locales/zh&#34;
	&#34;github.com/go-playground/universal-translator&#34;
	&#34;github.com/go-playground/validator/v10&#34;
	enTranslations &#34;github.com/go-playground/validator/v10/translations/en&#34;
	zhTranslations &#34;github.com/go-playground/validator/v10/translations/zh&#34;
)

// å®šä¹‰ä¸€ä¸ªå…¨å±€ç¿»è¯‘å™¨
var trans ut.Translator

// InitTrans åˆå§‹åŒ–ç¿»è¯‘å™¨
func InitTrans(locale string) (err error) {
	//ä¿®æ”¹ginæ¡†æ¶ä¸­çš„Validatorå±æ€§ï¼Œå®ç°è‡ªå®šåˆ¶
	if v, ok := binding.Validator.Engine().(*validator.Validate); ok {
		// æ³¨å†Œä¸€ä¸ªè·å–json tagçš„è‡ªå®šä¹‰æ–¹æ³•
		v.RegisterTagNameFunc(func(fld reflect.StructField) string {
			name := strings.SplitN(fld.Tag.Get(&#34;json&#34;), &#34;,&#34;, 2)[0]
			if name == &#34;-&#34; {
				return &#34;&#34;
			}
			return name
		})

		zhT := zh.New() //ä¸­æ–‡ç¿»è¯‘å™¨
		enT := en.New() //è‹±æ–‡ç¿»è¯‘å™¨

		// ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¤‡ç”¨ï¼ˆfallbackï¼‰çš„è¯­è¨€ç¯å¢ƒ
		// åé¢çš„å‚æ•°æ˜¯åº”è¯¥æ”¯æŒçš„è¯­è¨€ç¯å¢ƒï¼ˆæ”¯æŒå¤šä¸ªï¼‰
		// uni := ut.New(zhT, zhT) ä¹Ÿæ˜¯å¯ä»¥çš„
		uni := ut.New(enT, zhT, enT)

		// locale é€šå¸¸å–å†³äº http è¯·æ±‚å¤´çš„ &#39;Accept-Language&#39;
		var ok bool
		// ä¹Ÿå¯ä»¥ä½¿ç”¨ uni.FindTranslator(...) ä¼ å…¥å¤šä¸ªlocaleè¿›è¡ŒæŸ¥æ‰¾
		trans, ok = uni.GetTranslator(locale)
		if !ok {
			return fmt.Errorf(&#34;uni.GetTranslator(%s) failed&#34;, locale)
		}

		// æ·»åŠ é¢å¤–ç¿»è¯‘
		_ = v.RegisterTranslation(&#34;required_with&#34;, trans, func(ut ut.Translator) error {
			return ut.Add(&#34;required_with&#34;, &#34;{0} ä¸ºå¿…å¡«å­—æ®µ!&#34;, true)
		}, func(ut ut.Translator, fe validator.FieldError) string {
			t, _ := ut.T(&#34;required_with&#34;, fe.Field())
			return t
		})
		_ = v.RegisterTranslation(&#34;required_without&#34;, trans, func(ut ut.Translator) error {
			return ut.Add(&#34;required_without&#34;, &#34;{0} ä¸ºå¿…å¡«å­—æ®µ!&#34;, true)
		}, func(ut ut.Translator, fe validator.FieldError) string {
			t, _ := ut.T(&#34;required_without&#34;, fe.Field())
			return t
		})
		_ = v.RegisterTranslation(&#34;required_without_all&#34;, trans, func(ut ut.Translator) error {
			return ut.Add(&#34;required_without_all&#34;, &#34;{0} ä¸ºå¿…å¡«å­—æ®µ!&#34;, true)
		}, func(ut ut.Translator, fe validator.FieldError) string {
			t, _ := ut.T(&#34;required_without_all&#34;, fe.Field())
			return t
		})

		// æ³¨å†Œç¿»è¯‘å™¨
		switch locale {
		case &#34;en&#34;:
			err = enTranslations.RegisterDefaultTranslations(v, trans)
		case &#34;zh&#34;:
			err = zhTranslations.RegisterDefaultTranslations(v, trans)
		default:
			err = enTranslations.RegisterDefaultTranslations(v, trans)
		}
		return
	}
	return
}

func addValueToMap(fields map[string]string) map[string]interface{} {
	res := make(map[string]interface{})
	for field, err := range fields {
		fieldArr := strings.SplitN(field, &#34;.&#34;, 2)
		if len(fieldArr) &gt; 1 {
			NewFields := map[string]string{fieldArr[1]: err}
			returnMap := addValueToMap(NewFields)
			if res[fieldArr[0]] != nil {
				for k, v := range returnMap {
					res[fieldArr[0]].(map[string]interface{})[k] = v
				}
			} else {
				res[fieldArr[0]] = returnMap
			}
			continue
		} else {
			res[field] = err
			continue
		}
	}
	return res
}

// å»æ‰ç»“æ„ä½“åç§°å‰ç¼€
func removeTopStruct(fields map[string]string) map[string]interface{} {
	lowerMap := map[string]string{}
	for field, err := range fields {
		fieldArr := strings.SplitN(field, &#34;.&#34;, 2)
		lowerMap[fieldArr[1]] = err
	}
	res := addValueToMap(lowerMap)
	return res
}

//handlerä¸­è°ƒç”¨çš„é”™è¯¯ç¿»è¯‘æ–¹æ³•
func ValidatorError(err error) map[string]interface{} {
	errs, ok := err.(validator.ValidationErrors)
	if ok {
		return removeTopStruct(errs.Translate(trans))
	}
	return nil
}
</code></pre><h2 id="ä½¿ç”¨">ä½¿ç”¨ <a href="#%e4%bd%bf%e7%94%a8" class="anchor">ğŸ”—</a></h2><pre tabindex="0"><code>func (c *IndexController) Validator(ctx *gin.Context) {
	req := requests.AdminReq{}
	if err := ctx.ShouldBindJSON(&amp;req); err != nil {
		ctx.JSON(http.StatusBadRequest, gin.H{&#34;error&#34;: xcore.ValidatorError(err)})
		return
	}
	ctx.JSON(http.StatusNotFound, &#34;ok&#34;)
}
</code></pre>
    </div>

    
</section>


            </div>
            <div class="side">
                <div class="side-categories">
    <h2>Categories</h2>
    <hr />

    <ul>
        
            <li>
                <a href="/categories/ai">ai(3)</a>
            </li>
        
            <li>
                <a href="/categories/go">go(23)</a>
            </li>
        
            <li>
                <a href="/categories/%E4%BB%A3%E7%A0%81">ä»£ç (2)</a>
            </li>
        
            <li>
                <a href="/categories/%E5%B7%A5%E5%85%B7">å·¥å…·(8)</a>
            </li>
        
            <li>
                <a href="/categories/%E9%80%86%E5%90%91">é€†å‘(3)</a>
            </li>
        
            <li>
                <a href="/categories/%E9%9D%A2%E8%AF%95">é¢è¯•(5)</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/note/">Recent Note</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/note/%E6%9E%B6%E6%9E%84%E8%80%83%E7%82%B9/">åœºæ™¯æ€»ç»“</a>
            </li>
        
            <li>
                <a href="/note/rdis-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E9%9B%AA%E5%B4%A9%E5%87%BB%E7%A9%BF%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿çš„è§£å†³æ–¹æ³•</a>
            </li>
        
            <li>
                <a href="/note/redis-%E5%8D%95%E7%BA%BF%E7%A8%8B%E7%9A%84redis%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BF%AB/">å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆå¿«</a>
            </li>
        
            <li>
                <a href="/note/redis-%E6%80%BB%E7%BB%93/">redisæ€»ç»“</a>
            </li>
        
            <li>
                <a href="/note/mysql-%E6%80%BB%E7%BB%93/">mysqlæ€»ç»“</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/android/">Recent Android</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/android/redroid%E4%BD%BF%E7%94%A8/">Redroidå®‰å“å®¹å™¨</a>
            </li>
        
            <li>
                <a href="/android/%E5%85%A5%E9%97%A8/">é€†å‘ç¯å¢ƒ-æ‚</a>
            </li>
        
            <li>
                <a href="/android/frida%E6%95%99%E7%A8%8B/">fridaæ•™ç¨‹</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/tool/">Recent Tool</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/tool/linux-almalinux%E4%BC%98%E5%8C%96/">AlmaLinux10</a>
            </li>
        
            <li>
                <a href="/tool/almalinux-k8s/">AlmaLinux-k8så®‰è£…</a>
            </li>
        
            <li>
                <a href="/tool/vscode%E6%8A%98%E8%85%BE/">vscodeæŠ˜è…¾</a>
            </li>
        
            <li>
                <a href="/tool/linux-ubuntu%E4%BC%98%E5%8C%96/">Ubuntuå¼€æœºä¼˜åŒ–</a>
            </li>
        
            <li>
                <a href="/tool/shell-ssh_script/">sshå¸¸ç”¨è„šæœ¬</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/llm/">Recent Llm</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/llm/transformers-%E5%85%A5%E9%97%A8%E7%AF%87/">Transformers-å…¥é—¨ç¯‡</a>
            </li>
        
            <li>
                <a href="/llm/%E6%A8%A1%E5%9E%8Bvllm%E9%83%A8%E7%BD%B2/">AIæ¨¡å‹VLLMéƒ¨ç½²</a>
            </li>
        
            <li>
                <a href="/llm/%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83/">AIæ¨¡å‹å¾®è°ƒ</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/go/">Recent Go</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/go/go%E4%B8%89%E8%89%B2%E6%A0%87%E8%AE%B0%E6%B7%B7%E5%90%88%E5%86%99%E5%B1%8F%E9%9A%9Cgc%E6%A8%A1%E5%BC%8F%E5%85%A8%E6%80%BB%E7%BB%93/">Goä¸‰è‰²æ ‡è®°æ··åˆå†™å±éšœGCæ¨¡å¼å…¨æ€»ç»“</a>
            </li>
        
            <li>
                <a href="/go/go%E4%B8%ADmake%E4%B8%8Enew%E5%8C%BA%E5%88%AB/">Goä¸­makeä¸newåŒºåˆ«</a>
            </li>
        
            <li>
                <a href="/go/go%E5%B8%B8%E7%94%A8bug%E5%92%8C%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E7%9A%84%E5%AE%9E%E8%B7%B5%E6%96%B9%E6%B3%95/">Goå¸¸ç”¨bugå’Œæ€§èƒ½é—®é¢˜çš„å®è·µæ–¹æ³•</a>
            </li>
        
            <li>
                <a href="/go/grpc%E6%80%BB%E7%BB%93/">GRPCç¬”è®°</a>
            </li>
        
            <li>
                <a href="/go/go%E7%9A%84defer%E6%80%BB%E7%BB%93/">Goçš„deferæ€»ç»“</a>
            </li>
        
    </ul>
</div>

                
            </div>
        </main>
        <footer class="footer">
    <div class="footer-row">
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/note/index.xml">
                    Feed of Note
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/android/index.xml">
                    Feed of Android
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/tool/index.xml">
                    Feed of Tool
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/llm/index.xml">
                    Feed of Llm
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/go/index.xml">
                    Feed of Go
                    <i class="icofont-rss"></i>
                </a>
            
        

        
            
            
        
    </div>

    
</footer>

    </body>
</html>
