<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1">




<title>Goè¯­è¨€ç¼–ç¨‹æ¨¡å¼ | Abnerçš„åšå®¢</title>
<link rel="canonical" href="https://abnerxc.github.io/go/go%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%BC%8F/">
<meta property="og:type" content="article" />
<meta property="og:title" content="Goè¯­è¨€ç¼–ç¨‹æ¨¡å¼ | Abnerçš„åšå®¢" />
<meta property="og:url" content="https://abnerxc.github.io/go/go%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%BC%8F/" />








<link rel="stylesheet" href="/lib/icofont/icofont.min.css" />
<link rel="stylesheet" href="/css/syntax.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/custom.css" />
<script src="/js/copy-code-block.js"></script>
<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

    </head>

    <body>
        <header class="header-wrapper">
    <div class="header">
        <a class="site-title" href="https://abnerxc.github.io/">Abnerçš„åšå®¢</a>

        <nav class="menu">
            
        </nav>
    </div>
</header>

        <main class="main-wrapper">
            <div class="main">
                

<section class="single">
    <h1 class="title">Goè¯­è¨€ç¼–ç¨‹æ¨¡å¼</h1>

    <div class="tip">
        <time datetime="2019-01-15 18:35:11 &#43;0800 CST">2019/01/15</time>
        <span class="split">Â·</span>
        <span> 611 words </span>
        <span class="split">Â·</span>
        <span>
            3 minutes to read
        </span>
    </div>

    <div class="taxonomies">
        
        <div>
            Categories:
            
                <a href="/categories/go">Go</a>
            
        </div>
        

        
    </div>

    
    
    <div class="post-toc">
        <h3>ç›®å½•</h3>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#æ€§èƒ½æç¤º">æ€§èƒ½æç¤º</a></li>
    <li><a href="#æ¥å£ç¼–ç¨‹">æ¥å£ç¼–ç¨‹</a></li>
    <li><a href="#æ¥å£å®Œæ•´æ€§æ£€æŸ¥">æ¥å£å®Œæ•´æ€§æ£€æŸ¥</a></li>
    <li><a href="#functional-options-ç¼–ç¨‹æ¨¡å¼">Functional Options ç¼–ç¨‹æ¨¡å¼</a></li>
    <li><a href="#mapreducefilter-æ¨¡å¼">Map,Reduce,Filter æ¨¡å¼</a></li>
  </ul>
</nav>
    </div>
    

    <hr />

    <div class="content">
        <h1 id="æ€§èƒ½æç¤º">æ€§èƒ½æç¤º <a href="#%e6%80%a7%e8%83%bd%e6%8f%90%e7%a4%ba" class="anchor">ğŸ”—</a></h1><ul>
<li>å¦‚æœéœ€è¦æŠŠæ•°å­—è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œä½¿ç”¨ strconv.Itoa() æ¯” fmt.Sprintf() è¦å¿«ä¸€å€å·¦å³ã€‚</li>
<li>å°½å¯èƒ½é¿å…æŠŠStringè½¬æˆ[]Byte ï¼Œè¿™ä¸ªè½¬æ¢ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</li>
<li>å¦‚æœåœ¨ for-loop é‡Œå¯¹æŸä¸ª Slice ä½¿ç”¨ append()ï¼Œè¯·å…ˆæŠŠ Slice çš„å®¹é‡æ‰©å……åˆ°ä½ï¼Œè¿™æ ·å¯ä»¥é¿å…å†…å­˜é‡æ–°åˆ†é…ä»¥åŠç³»ç»Ÿè‡ªåŠ¨æŒ‰ 2 çš„ N æ¬¡æ–¹å¹‚è¿›è¡Œæ‰©å±•ä½†åˆç”¨ä¸åˆ°çš„æƒ…å†µï¼Œä»è€Œé¿å…æµªè´¹å†…å­˜ã€‚</li>
<li>ä½¿ç”¨StringBuffer æˆ–æ˜¯StringBuild æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæ€§èƒ½ä¼šæ¯”ä½¿ç”¨ + æˆ– +=é«˜ä¸‰åˆ°å››ä¸ªæ•°é‡çº§ã€‚</li>
<li>å°½å¯èƒ½ä½¿ç”¨å¹¶å‘çš„ goroutineï¼Œç„¶åä½¿ç”¨ sync.WaitGroup æ¥åŒæ­¥åˆ†ç‰‡æ“ä½œã€‚</li>
<li>é¿å…åœ¨çƒ­ä»£ç ä¸­è¿›è¡Œå†…å­˜åˆ†é…ï¼Œè¿™æ ·ä¼šå¯¼è‡´ gc å¾ˆå¿™ã€‚å°½å¯èƒ½ä½¿ç”¨ sync.Pool æ¥é‡ç”¨å¯¹è±¡ã€‚</li>
<li>ä½¿ç”¨ lock-free çš„æ“ä½œï¼Œé¿å…ä½¿ç”¨ mutexï¼Œå°½å¯èƒ½ä½¿ç”¨ sync/AtomicåŒ…</li>
<li>ä½¿ç”¨ I/O ç¼“å†²ï¼ŒI/O æ˜¯ä¸ªéå¸¸éå¸¸æ…¢çš„æ“ä½œï¼Œä½¿ç”¨ bufio.NewWrite() å’Œ bufio.NewReader() å¯ä»¥å¸¦æ¥æ›´é«˜çš„æ€§èƒ½ã€‚</li>
<li>å¯¹äºåœ¨ for-loop é‡Œçš„å›ºå®šçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸€å®šè¦ä½¿ç”¨ regexp.Compile() ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ã€‚æ€§èƒ½ä¼šæå‡ä¸¤ä¸ªæ•°é‡çº§ã€‚</li>
<li>å¦‚æœä½ éœ€è¦æ›´é«˜æ€§èƒ½çš„åè®®ï¼Œå°±è¦è€ƒè™‘ä½¿ç”¨ protobuf æˆ– msgp è€Œä¸æ˜¯ JSONï¼Œå› ä¸º JSON çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–é‡Œä½¿ç”¨äº†åå°„ã€‚</li>
<li>ä½ åœ¨ä½¿ç”¨ Map çš„æ—¶å€™ï¼Œä½¿ç”¨æ•´å‹çš„ key ä¼šæ¯”å­—ç¬¦ä¸²çš„è¦å¿«ï¼Œå› ä¸ºæ•´å‹æ¯”è¾ƒæ¯”å­—ç¬¦ä¸²æ¯”è¾ƒè¦å¿«ã€‚</li>
</ul>
<h1 id="æ¥å£ç¼–ç¨‹">æ¥å£ç¼–ç¨‹ <a href="#%e6%8e%a5%e5%8f%a3%e7%bc%96%e7%a8%8b" class="anchor">ğŸ”—</a></h1><pre tabindex="0"><code>
type Country struct {
    Name string
}

type City struct {
    Name string
}

type Printable interface {
    PrintStr()
}
func (c Country) PrintStr() {
    fmt.Println(c.Name)
}
func (c City) PrintStr() {
    fmt.Println(c.Name)
}

c1 := Country {&#34;China&#34;}
c2 := City {&#34;Beijing&#34;}
c1.PrintStr()
c2.PrintStr()
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ®µä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ª Printable çš„æ¥å£ï¼Œè€Œ Country å’Œ City éƒ½å®ç°äº†æ¥å£æ–¹æ³• PrintStr() æŠŠè‡ªå·±è¾“å‡ºã€‚ç„¶è€Œï¼Œè¿™äº›ä»£ç éƒ½æ˜¯ä¸€æ ·çš„ï¼Œèƒ½ä¸èƒ½çœæ‰å‘¢ï¼Ÿå…¶å®ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œç»“æ„ä½“åµŒå…¥â€çš„æ–¹å¼æ¥å®Œæˆè¿™ä¸ªäº‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre tabindex="0"><code>
type WithName struct {
    Name string
}

type Country struct {
    WithName
}

type City struct {
    WithName
}

type Printable interface {
    PrintStr()
}

func (w WithName) PrintStr() {
    fmt.Println(w.Name)
}

c1 := Country {WithName{ &#34;China&#34;}}
c2 := City { WithName{&#34;Beijing&#34;}}
c1.PrintStr()
c2.PrintStr()
</code></pre><p>å¼•å…¥ä¸€ä¸ªå« WithNameçš„ç»“æ„ä½“ï¼Œä½†æ˜¯è¿™ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šåœ¨åˆå§‹åŒ–çš„æ—¶å€™å˜å¾—æœ‰ç‚¹ä¹±ã€‚é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„æ–¹æ³•å‘¢ï¼Ÿå†æ¥çœ‹å¦å¤–ä¸€ä¸ªè§£ã€‚</p>
<pre tabindex="0"><code>
type Country struct {
    Name string
}

type City struct {
    Name string
}

type Stringable interface {
    ToString() string
}
func (c Country) ToString() string {
    return &#34;Country = &#34; + c.Name
}
func (c City) ToString() string{
    return &#34;City = &#34; + c.Name
}

func PrintStr(p Stringable) {
    fmt.Println(p.ToString())
}

d1 := Country {&#34;USA&#34;}
d2 := City{&#34;Los Angeles&#34;}
PrintStr(d1)
PrintStr(d2)
</code></pre><p>åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå«Stringable çš„æ¥å£ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªæ¥å£æŠŠâ€œä¸šåŠ¡ç±»å‹â€ Country å’Œ City å’Œâ€œæ§åˆ¶é€»è¾‘â€ Print() ç»™è§£è€¦äº†ã€‚äºæ˜¯ï¼Œåªè¦å®ç°äº†Stringable æ¥å£ï¼Œéƒ½å¯ä»¥ä¼ ç»™ PrintStr() æ¥ä½¿ç”¨ã€‚</p>
<h1 id="æ¥å£å®Œæ•´æ€§æ£€æŸ¥">æ¥å£å®Œæ•´æ€§æ£€æŸ¥ <a href="#%e6%8e%a5%e5%8f%a3%e5%ae%8c%e6%95%b4%e6%80%a7%e6%a3%80%e6%9f%a5" class="anchor">ğŸ”—</a></h1><pre tabindex="0"><code>
type Shape interface {
    Sides() int
    Area() int
}
type Square struct {
    len int
}
func (s* Square) Sides() int {
    return 4
}
func main() {
    s := Square{len: 5}
    fmt.Printf(&#34;%d\n&#34;,s.Sides())
}
</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼ŒSquare å¹¶æ²¡æœ‰å®ç° Shape æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œç¨‹åºè™½ç„¶å¯ä»¥è·‘é€šï¼Œä½†æ˜¯è¿™æ ·çš„ç¼–ç¨‹æ–¹å¼å¹¶ä¸ä¸¥è°¨ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦å¼ºåˆ¶å®ç°æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<pre tabindex="0"><code>var _ Shape = (*Square)(nil)
</code></pre><p>å£°æ˜ä¸€ä¸ª _ å˜é‡ï¼ˆæ²¡äººç”¨ï¼‰ä¼šæŠŠä¸€ä¸ª nil çš„ç©ºæŒ‡é’ˆä» Square è½¬æˆ Shapeï¼Œè¿™æ ·ï¼Œå¦‚æœæ²¡æœ‰å®ç°å®Œç›¸å…³çš„æ¥å£æ–¹æ³•ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™ï¼š</p>
<blockquote>
<p>cannot use (*Square)(nil) (type *Square) as type Shape in assignment: *Square does not implement Shape (missing Area method)</p>
</blockquote>
<h1 id="functional-options-ç¼–ç¨‹æ¨¡å¼">Functional Options ç¼–ç¨‹æ¨¡å¼ <a href="#functional-options-%e7%bc%96%e7%a8%8b%e6%a8%a1%e5%bc%8f" class="anchor">ğŸ”—</a></h1><pre tabindex="0"><code>package main

import (
	&#34;crypto/tls&#34;
	&#34;fmt&#34;
	&#34;time&#34;
)

type Option func(*Server)

type Server struct {
	Addr     string
	Port     int
	Protocol string
	Timeout  time.Duration
	MaxConns int
	TLS      *tls.Config
}

func Protocol(p string) Option {
	return func(s *Server) {
		s.Protocol = p
	}
}
func Timeout(timeout time.Duration) Option {
	return func(s *Server) {
		s.Timeout = timeout
	}
}
func MaxConns(maxconns int) Option {
	return func(s *Server) {
		s.MaxConns = maxconns
	}
}
func TLS(tls *tls.Config) Option {
	return func(s *Server) {
		s.TLS = tls
	}
}
func NewService(addr string, port int, options ...func(*Server)) (*Server, error) {
	srv := Server{
		Addr:     addr,
		Port:     port,
		Protocol: &#34;tcp&#34;,
		Timeout:  30 * time.Second,
		MaxConns: 1000,
		TLS:      nil,
	}
	for _, option := range options {
		option(&amp;srv)
	} //...
	return &amp;srv, nil
}

func main() {
	server, _ := NewService(&#34;localhost&#34;, 80, Protocol(&#34;ftp&#34;),Timeout(5*10))
	fmt.Println(server)
}
</code></pre><h1 id="mapreducefilter-æ¨¡å¼">Map,Reduce,Filter æ¨¡å¼ <a href="#mapreducefilter-%e6%a8%a1%e5%bc%8f" class="anchor">ğŸ”—</a></h1><pre tabindex="0"><code>
type Employee struct {
    Name     string
    Age      int
    Vacation int
    Salary   int
}

var list = []Employee{
    {&#34;Hao&#34;, 44, 0, 8000},
    {&#34;Bob&#34;, 34, 10, 5000},
    {&#34;Alice&#34;, 23, 5, 9000},
    {&#34;Jack&#34;, 26, 0, 4000},
    {&#34;Tom&#34;, 48, 9, 7500},
    {&#34;Marry&#34;, 29, 0, 6000},
    {&#34;Mike&#34;, 32, 8, 4000},
}


func EmployeeCountIf(list []Employee, fn func(e *Employee) bool) int {
    count := 0
    for i, _ := range list {
        if fn(&amp;list[i]) {
            count += 1
        }
    }
    return count
}

func EmployeeFilterIn(list []Employee, fn func(e *Employee) bool) []Employee {
    var newList []Employee
    for i, _ := range list {
        if fn(&amp;list[i]) {
            newList = append(newList, list[i])
        }
    }
    return newList
}

func EmployeeSumIf(list []Employee, fn func(e *Employee) int) int {
    var sum = 0
    for i, _ := range list {
        sum += fn(&amp;list[i])
    }
    return sum
}

//ç»Ÿè®¡æœ‰å¤šå°‘å‘˜å·¥å¤§äº 40 å²

old := EmployeeCountIf(list, func(e *Employee) bool {
    return e.Age &gt; 40
})
fmt.Printf(&#34;old people: %d\n&#34;, old)
//old people: 2
</code></pre>
    </div>

    
</section>


            </div>
            <div class="side">
                <div class="side-categories">
    <h2>Categories</h2>
    <hr />

    <ul>
        
            <li>
                <a href="/categories/ai">ai(3)</a>
            </li>
        
            <li>
                <a href="/categories/go">go(23)</a>
            </li>
        
            <li>
                <a href="/categories/%E4%BB%A3%E7%A0%81">ä»£ç (2)</a>
            </li>
        
            <li>
                <a href="/categories/%E5%B7%A5%E5%85%B7">å·¥å…·(8)</a>
            </li>
        
            <li>
                <a href="/categories/%E9%80%86%E5%90%91">é€†å‘(3)</a>
            </li>
        
            <li>
                <a href="/categories/%E9%9D%A2%E8%AF%95">é¢è¯•(5)</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/note/">Recent Note</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/note/%E6%9E%B6%E6%9E%84%E8%80%83%E7%82%B9/">åœºæ™¯æ€»ç»“</a>
            </li>
        
            <li>
                <a href="/note/rdis-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E9%9B%AA%E5%B4%A9%E5%87%BB%E7%A9%BF%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/">ç¼“å­˜ç©¿é€ã€é›ªå´©ã€å‡»ç©¿çš„è§£å†³æ–¹æ³•</a>
            </li>
        
            <li>
                <a href="/note/redis-%E5%8D%95%E7%BA%BF%E7%A8%8B%E7%9A%84redis%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BF%AB/">å•çº¿ç¨‹çš„redisä¸ºä»€ä¹ˆå¿«</a>
            </li>
        
            <li>
                <a href="/note/redis-%E6%80%BB%E7%BB%93/">redisæ€»ç»“</a>
            </li>
        
            <li>
                <a href="/note/mysql-%E6%80%BB%E7%BB%93/">mysqlæ€»ç»“</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/android/">Recent Android</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/android/redroid%E4%BD%BF%E7%94%A8/">Redroidå®‰å“å®¹å™¨</a>
            </li>
        
            <li>
                <a href="/android/%E5%85%A5%E9%97%A8/">é€†å‘ç¯å¢ƒ-æ‚</a>
            </li>
        
            <li>
                <a href="/android/frida%E6%95%99%E7%A8%8B/">fridaæ•™ç¨‹</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/tool/">Recent Tool</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/tool/linux-almalinux%E4%BC%98%E5%8C%96/">AlmaLinux10</a>
            </li>
        
            <li>
                <a href="/tool/almalinux-k8s/">AlmaLinux-k8så®‰è£…</a>
            </li>
        
            <li>
                <a href="/tool/vscode%E6%8A%98%E8%85%BE/">vscodeæŠ˜è…¾</a>
            </li>
        
            <li>
                <a href="/tool/linux-ubuntu%E4%BC%98%E5%8C%96/">Ubuntuå¼€æœºä¼˜åŒ–</a>
            </li>
        
            <li>
                <a href="/tool/shell-ssh_script/">sshå¸¸ç”¨è„šæœ¬</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/llm/">Recent Llm</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/llm/transformers-%E5%85%A5%E9%97%A8%E7%AF%87/">Transformers-å…¥é—¨ç¯‡</a>
            </li>
        
            <li>
                <a href="/llm/%E6%A8%A1%E5%9E%8Bvllm%E9%83%A8%E7%BD%B2/">AIæ¨¡å‹VLLMéƒ¨ç½²</a>
            </li>
        
            <li>
                <a href="/llm/%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83/">AIæ¨¡å‹å¾®è°ƒ</a>
            </li>
        
    </ul>
</div>

                
                    <div class="side-recent">
    <h2 class="side-title">
        <a href="/go/">Recent Go</a>
    </h2>
    <hr />

    <ul>
        
            <li>
                <a href="/go/go%E4%B8%89%E8%89%B2%E6%A0%87%E8%AE%B0%E6%B7%B7%E5%90%88%E5%86%99%E5%B1%8F%E9%9A%9Cgc%E6%A8%A1%E5%BC%8F%E5%85%A8%E6%80%BB%E7%BB%93/">Goä¸‰è‰²æ ‡è®°æ··åˆå†™å±éšœGCæ¨¡å¼å…¨æ€»ç»“</a>
            </li>
        
            <li>
                <a href="/go/go%E4%B8%ADmake%E4%B8%8Enew%E5%8C%BA%E5%88%AB/">Goä¸­makeä¸newåŒºåˆ«</a>
            </li>
        
            <li>
                <a href="/go/go%E5%B8%B8%E7%94%A8bug%E5%92%8C%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E7%9A%84%E5%AE%9E%E8%B7%B5%E6%96%B9%E6%B3%95/">Goå¸¸ç”¨bugå’Œæ€§èƒ½é—®é¢˜çš„å®è·µæ–¹æ³•</a>
            </li>
        
            <li>
                <a href="/go/grpc%E6%80%BB%E7%BB%93/">GRPCç¬”è®°</a>
            </li>
        
            <li>
                <a href="/go/go%E7%9A%84defer%E6%80%BB%E7%BB%93/">Goçš„deferæ€»ç»“</a>
            </li>
        
    </ul>
</div>

                
            </div>
        </main>
        <footer class="footer">
    <div class="footer-row">
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/note/index.xml">
                    Feed of Note
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/android/index.xml">
                    Feed of Android
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/tool/index.xml">
                    Feed of Tool
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/llm/index.xml">
                    Feed of Llm
                    <i class="icofont-rss"></i>
                </a>
            
        
            
            
                <a class="footer-item" href="https://abnerxc.github.io/go/index.xml">
                    Feed of Go
                    <i class="icofont-rss"></i>
                </a>
            
        

        
            
            
        
    </div>

    
</footer>

    </body>
</html>
